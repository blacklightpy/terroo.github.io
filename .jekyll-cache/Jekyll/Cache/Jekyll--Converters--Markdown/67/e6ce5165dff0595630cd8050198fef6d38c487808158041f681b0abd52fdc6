I"%<p>Configuring Mirrors on Gentoo</p>

<p>Sometimes when we install something via <a href="https://wiki.gentoo.org/wiki/Portage#emerge">Portage</a>, and we realize that the data download is very slow, this slowness may be directly related to the fact that the repository closest to our location (repository of the country where we live) is not defined. So we can solve this problem by selecting a repository for our system.</p>

<p>First we will install with the user <strong>root</strong> <code class="highlighter-rouge">su</code> a package called <code class="highlighter-rouge">mirrorselect</code></p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">emerge <span class="nt">-a</span> mirrorselect</code></pre></figure>

<p>After installing it now we need to run the command below to select our repository:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nt">-i</span>, <span class="nt">--interactive</span>
              Interactive Mode, this will present a list to make it possible to <span class="k">select </span>mirrors you wish to use.
<span class="nt">-o</span>, <span class="nt">--output</span>
              Output Only Mode, this is especially useful when being used during installation, to redirect output to a file other than /etc/portage/make.conf.</code></pre></figure>

<blockquote>
  <p><strong>Note</strong>: that it is necessary to use <code class="highlighter-rouge">-o</code> with the double redirection <code class="highlighter-rouge">&gt;&gt;</code> to work, remember that it is a <strong>DOUBLE REDIRECT</strong> <code class="highlighter-rouge">&gt;&gt;</code> not to overwrite your <em>make.conf</em> file.</p>
</blockquote>

<p><img src="/assets/img/tips/IMG1-mirrors.gif" alt="Configuring Mirrors on Gentoo" title="Configuring Mirrors on Gentoo" /></p>

<p>It will open a dialog and select the repositories you want, use the space key on your keyboard to ‘check’ the desired options. In that case, notice that I have selected all repositories in Canada.</p>

<blockquote>
  <p><strong>Note</strong>: that after accepting the <strong>terminal</strong> does not clean the contents, however, the <strong>prompt</strong> is returned, if you want to <em>clean</em> the terminal use the command <code class="highlighter-rouge">tput reset</code></p>
</blockquote>

<p><img src="/assets/img/tips/IMG2-mirrors.gif" alt="Configuring Mirrors on Gentoo" title="Configuring Mirrors on Gentoo" /></p>

<p>Then check <em>make.conf</em> and notice that at the end of the file there is now a <strong>GENTOO_MIRRORS</strong> variable with the <em>‘rsync, ftp and http’</em> repositories defined with the address we selected.</p>

<p><img src="/assets/img/tips/IMG3-mirrors.gif" alt="Configuring Mirrors on Gentoo" title="Configuring Mirrors on Gentoo" /></p>

<blockquote>
  <p>Optional:</p>
</blockquote>

<p>If you do not already have the definitions of repositories created, run the following commands:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">mkdir</span> <span class="nt">--parents</span> /etc/portage/repos.conf
<span class="nb">cp</span> /usr/share/portage/config/repos.conf/etc/portage/repos.conf/gentoo.conf
<span class="nb">cat</span> /etc/portage/repos.conf/gentoo.conf

<span class="o">[</span>DEFAULT]
main-repo <span class="o">=</span> gentoo

<span class="o">[</span>gentoo]
location <span class="o">=</span> /usr/portage
sync-type <span class="o">=</span> rsync
sync-uri <span class="o">=</span> rsync://rsync.gentoo.org/gentoo-portage
auto-sync <span class="o">=</span> <span class="nb">yes
</span>sync-rsync-verify-jobs <span class="o">=</span> 1
sync-rsync-verify-metamanifest <span class="o">=</span> no
sync-rsync-verify-max-age <span class="o">=</span> 24
sync-openpgp-key-path <span class="o">=</span> /usr/share/openpgp-keys/gentoo-release.asc
sync-openpgp-key-refresh-retry-count <span class="o">=</span> 40
sync-openpgp-key-refresh-retry-overall-timeout <span class="o">=</span> 1200
sync-openpgp-key-refresh-retry-delay-exp-base <span class="o">=</span> 2
sync-openpgp-key-refresh-retry-delay-max <span class="o">=</span> 60
sync-openpgp-key-refresh-retry-delay-mult <span class="o">=</span> 4

<span class="c"># for daily squashfs snapshots</span>
<span class="c">#sync-type = squashdelta</span>
<span class="c">#sync-uri = mirror://gentoo/../snapshots/squashfs</span></code></pre></figure>

<p>Most likely now downloads during Portage installations will be faster!</p>

<p>More information: https://wiki.gentoo.org/wiki/Handbook:AMD64/Full/Installation#Crooting</p>
:ET